<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>AskMeWhat</title>
  <link rel="icon" href="{{ url_for('static', filename='images/resicon.jpeg') }}" type="image" sizes="16x16">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='styles/style.css') }}">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"></script>

  <link rel="stylesheet" href="{{ url_for('static', filename='assets/bootstrap/css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Catamaran:100,200,300,400,500,600,700,800,900">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:100,100i,300,300i,400,400i,700,700i,900,900i">
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/fonts/ionicons.min.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/Login-Form-Dark.css') }}">

</head>

<body>
  <section class="msger">
   

      <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <a class="navbar-brand" href="#" style="color: white;">
          &emsp;<i class="fas fa-graduation-cap"></i> <b> &nbsp; AskMeWhat &emsp; </b></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
          aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ml-auto">

            <li class="nav-item active"><a class="nav-link" href="/index">Home</a></li>

            
            <li class="nav-item">
              <a class="nav-link" data-toggle="modal" data-target="#exampleModalScrollable" href="#">About Us</a>
            </li>

            <li class="nav-item">
              <a class="nav-link" data-toggle="modal" data-target="#exampleModal" href="#">Suggestion box</a>
            </li>


            <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Suggestion box</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <form action='/suggestion' method='POST'>
                      <div class="form-group">
                        <input type="email" name='uemail' class='form-control' placeholder="Email" value='{{session["iddd"]}}' required>
                        <br>
                        <textarea class="form-control" id="message-text" placeholder="Enter your suggestion..." name="message" required></textarea>
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="Submit" class="btn btn-primary" data-target="#alert">Submit</button>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal fade" id="exampleModalScrollable" tabindex="-1" role="dialog"
              aria-labelledby="exampleModalScrollableTitle" aria-hidden="true">
              <div class="modal-dialog modal-dialog-scrollable" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalScrollableTitle">AskMeWhat </h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                   <h3>About Us</h3>
                  <div>
                    <img src="https://www.sastra.edu/images/sastra/Newbuilding.jpg" alt="Wallpaper" height="auto" width="100%" style="border: 3px solid black;"/>
                  </div>
                    <br> <br>
                   <p style="text-align: justify;">With a humble beginning in the year 1984, SASTRA’s progress in the last 36 years is a testimony to its commitment to build a University as envisaged in its guiding model. Today, SASTRA is one of India’s premier institutions offering undergraduate, postgraduate & doctoral programmes in Engineering, Management, Law, Sciences, Humanities and Education. It was conferred Deemed-to-be-University status in 2001 by the University Grants Commission under Section 3 of the UGC Act 1956. SASTRA also has an MHRD-notified off-campus named Srinivasa Ramanujan Centre (SRC) at Kumbakonam.</p>

                    <p style="text-align: justify;">As a comprehensive University, its teaching programmes are complemented by research engagements, consultancy assignments, training and extension activities. It had been re-accredited by NAAC (third cycle) with a maximum grade of ‘A+’ (3.54/4.00) and is a Category I Institution based on the UGC’s categorization of Universities for Graded Autonomy Regulations, 2018. Twelve engineering programmes of SASTRA have been internationally accredited for a period of 9 years by the Institution of Engineering & Technology (IET), UK recognizing SASTRA’s academic excellence. In the NIRF ranking, SASTRA has always been placed among the top 40 Universities with a current position of 25 in 2020. It is also recognized as a Scientific & Industrial Research Organization by the Government of India.</p>
                    
                   
                    <h3>Contact</h3>
                    
                    <ul>
                    <li style = "margin-left:15px">E.Karthikeyan 122003112@sastra.ac.in</li>
                    <li style = "margin-left:15px">S.Dhanushkumar 122003066@sastra.ac.in</li>
                    </ul>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                  </div>
                </div>
              </div>
            </div>
            <li class="nav-item"><a class="nav-link" href="/logout" onclick=stop()>Log Out</a></li>
            
          </ul>
        </div>
    
   
    </nav>
    <!--header class="msger-header">
      <div class="msger-header-title">
        <h5><i class="fas fa-graduation-cap"></i> <b> &emsp; AskMeWhat &emsp; </b><i class="fas fa-graduation-cap"></i></h5>
      </div>
    </header-->
    {% with messages = get_flashed_messages() %}
    {% if messages %}
    {% for message in messages %}
    <div class="alert alert-success alert-dismissible" id="alert" role="alert">
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
      <strong>{{ message }}</strong>
    </div>
    {% endfor %}
    {% endif %}
    {% endwith %}
   
   
    <main class="msger-chat" style="color: white;">
    </br>
      <div class="msg left-msg">       
        <div class="msg-img" style = "background-image: url(https://th.bing.com/th/id/R.c87d21a84006916c9fe35cd25c6812e6?rik=Vpn8%2bhyiQncJmQ&riu=http%3a%2f%2fwww.sastra.edu%2fstaffprofiles%2fimg%2flogo.png&ehk=4aeBXVbcqgN38FFPOI%2fvErFf6DCTgx2Zl7jX%2b9GwFo0%3d&risl=&pid=ImgRaw&r=0)">
        </div>
        <div class="msg-bubble">
          <div class="msg-info">
            <div class="msg-info-name"><b>AskMeWhat</b> </div>
          </div>      
              
          <div class="msg-text" style="color: white;">
            <b >Hii!, I am here to answer your queries.
          </div>
        </div>
      </div> 
      </div>

    </main>

    <form class="msger-inputarea">
      <input type="text" class="msger-input" id="textInput" placeholder="Enter your message..." >
      <button type="submit" class="msger-send-btn">Send</button>
      <button type="record" class="msger-send-btn" onclick=record()>Record</button>
    </form>
  </section>
  <!-- partial -->
  <script>
     function stop(){
      var synth= window.speechSynthesis;
      if(synth.speaking)
        synth.cancel();
     }
     function record() {
            var recognition = new webkitSpeechRecognition();
            recognition.lang = "en-GB";

            recognition.onresult = function(event) {
                // console.log(event);
                document.getElementById('textInput').value = event.results[0][0].transcript;
            }
            recognition.start();

        }
  </script>
  <script src='https://use.fontawesome.com/releases/v5.0.13/js/all.js'></script>
  <script>

    $("#alert").delay(3000).slideUp(200, function() {
    $(this).alert('close');
    });

    $('#myModal').on('shown.bs.modal', function () {
      $('#myInput').trigger('focus')
    })
    
    const msgerForm = get(".msger-inputarea");
    const msgerInput = get(".msger-input");
    const msgerChat = get(".msger-chat");

    // https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSByXho41yToOFz5UcHHwct3X-OWwkft_akfA&usqp=CAU
    
    const BOT_IMG ='https://th.bing.com/th/id/R.c87d21a84006916c9fe35cd25c6812e6?rik=Vpn8%2bhyiQncJmQ&riu=http%3a%2f%2fwww.sastra.edu%2fstaffprofiles%2fimg%2flogo.png&ehk=4aeBXVbcqgN38FFPOI%2fvErFf6DCTgx2Zl7jX%2b9GwFo0%3d&risl=&pid=ImgRaw&r=0'
    const PERSON_IMG = "https://cdn4.iconfinder.com/data/icons/small-n-flat/24/user-alt-512.png";
    const BOT_NAME = "AskMeWhat";
    const PERSON_NAME = "You";

    msgerForm.addEventListener("submit", event => {
      event.preventDefault();

      const msgText = msgerInput.value;
      if (!msgText) return;

      appendMessage(PERSON_NAME, PERSON_IMG, "right", msgText);
      msgerInput.value = "";

      botResponse(msgText);
    });

    function appendMessage(name, img, side, text) {
      const msgHTML = `
<div class="msg ${side}-msg">
  <div class="msg-img" style="background-image: url(${img})"></div>

  <div class="msg-bubble">
    <div class="msg-info">
      <div class="msg-info-name">${name}</div>
      <div class="msg-info-time">${formatDate(new Date())}</div>
    </div>

    <div class="msg-text">${text}</div>
  </div>
</div>
`;

      msgerChat.insertAdjacentHTML("beforeend", msgHTML);
      msgerChat.scrollTop += 500;
    }

    function botResponse(rawText) {

      // Bot Response
      $.get("/get", { msg: rawText }).done(function (data) {
        var synth = window.speechSynthesis;
        if(synth.speaking)
          synth.cancel();
        console.log(rawText);
        console.log(data);
        const msgText = data;
        appendMessage(BOT_NAME, BOT_IMG, "left", msgText);

        var utterance = new SpeechSynthesisUtterance(msgText);
        synth.speak(utterance);

      });

    }


    // Utils
    function get(selector, root = document) {
      return root.querySelector(selector);
    }

    function formatDate(date) {
      const h = "0" + date.getHours();
      const m = "0" + date.getMinutes();

      return `${h.slice(-2)}:${m.slice(-2)}`;
    }

  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>
</body>

</html>
